{"version":3,"sources":["../../../src/core/logger.ts"],"names":["promises","fs","path","Buffer","process","LogLevel","Logger","instance","config","context","fileHandle","currentFileSize","currentFileIndex","isClosing","level","format","destination","filePath","Error","getInstance","isTestEnv","env","CLAUDE_FLOW_ENV","configure","close","debug","message","meta","log","info","warn","error","undefined","child","console","data","shouldLog","entry","timestamp","Date","toISOString","formatted","writeToConsole","writeToFile","configLevel","toUpperCase","jsonEntry","name","stack","JSON","stringify","contextStr","Object","keys","length","dataStr","errorStr","shouldRotate","rotate","open","from","write","maxFileSize","stat","size","maxFiles","replace","rotatedPath","rename","cleanupOldFiles","dir","dirname","baseFileName","basename","entries","readdir","withFileTypes","files","isFile","startsWith","push","sort","reverse","filesToRemove","slice","file","unlink","join","logger"],"mappings":"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"}